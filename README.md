# 媒体管理中心

一个简单的媒体文件管理系统，支持分组管理、权限控制和文件预览。

## 功能特点

| 功能 | 访客 | 管理员 |
|------|------|--------|
| 浏览分组和文件 | ✅ | ✅ |
| 预览图片和视频 | ✅ | ✅ |
| 下载文件 | ✅ | ✅ |
| 上传文件 | ❌ | ✅ |
| 创建/删除分组 | ❌ | ✅ |
| 删除文件 | ❌ | ✅ |

- 📸 支持图片：JPG, PNG, GIF, BMP, WEBP
- 🎬 支持视频：MP4, AVI, MOV, MKV, FLV, WEBM
- 📁 智能命名：`分组名_序号.扩展名`（如：奥奇_1.jpg）
- 👤 默认账号：`xkz666` / `xkz666`

## 快速开始

### 1. 安装依赖

```bash
pip install -r requirements.txt
```

### 2. 启动服务

```bash
python app.py
```

### 3. 访问网站

打开浏览器：http://localhost:5000

## 使用说明

### 本地运行

1. **访客模式**（无需登录）
   - 查看所有分组和文件
   - 预览和下载文件
   - 无法上传或删除

2. **管理员模式**
   - 点击右上角「登录」
   - 输入账号：`xkz666`，密码：`xkz666`
   - 即可上传、删除、创建分组

### 文件命名规则

上传的文件自动命名为：`分组名_序号.扩展名`

**示例：**
- 分组「奥奇」的第1个文件 → `奥奇_1.jpg`
- 第2个文件 → `奥奇_2.png`
- 分组「旅行」的第1个文件 → `旅行_1.jpg`

序号自动递增，删除文件后序号继续累加。

### 文件存储

上传的文件保存在：
```
project/
└── uploads/
    └── 分组名/
        ├── 奥奇_1.jpg
        └── 奥奇_2.png
```

## 部署到公网

### 推荐方案：阿里云轻量服务器（香港节点）

**为什么选择：**
- 99元/年（每天不到3毛）
- 国内访问极快，无需翻墙
- 免备案（选择香港节点）
- 完全自主掌控

**部署步骤：**

1. 购买服务器
   - 访问：https://www.aliyun.com/product/swas
   - 地域选择：**中国香港**（免备案）
   - 镜像：Ubuntu
   - 套餐：2核2G（99元/年）

2. 连接服务器（Windows用Xshell，Mac/Linux用终端）
   ```bash
   ssh root@你的公网IP
   ```

3. 安装环境
   ```bash
   apt update
   apt install python3 python3-pip git screen -y
   ```

4. 上传并部署项目
   ```bash
   cd ~
   # 上传项目文件到服务器
   cd media-center
   python3 -m venv venv
   source venv/bin/activate
   pip install -r requirements.txt
   mkdir -p uploads
   ```

5. 配置防火墙
   - 阿里云控制台 → 安全组 → 放行 5000 端口

6. 启动服务
   ```bash
   screen -S media
   source venv/bin/activate
   python3 app.py
   # Ctrl+A 然后按 D 退出（服务继续运行）
   ```

7. 访问网站
   ```
   http://你的公网IP:5000
   ```

### 备选方案

| 方案 | 价格 | 难度 | 特点 |
|------|------|------|------|
| Render | 免费 | 简单 | 需要翻墙访问 |
| PythonAnywhere | 免费 | 中等 | 海外访问一般 |
| 腾讯云轻量 | 99元/年 | 中等 | 国内备选 |

## 常见问题

### 上传后文件不显示或没有后缀名

**原因：** 文件名中的空格或特殊字符导致处理异常

**解决：**
- 避免文件名中包含空格
- 避免特殊字符：`/ \ : * ? " < > |`
- 推荐使用：`photo_1.jpg` 或 `照片1.jpg`

### 如何修改默认账号

编辑 `app.py`：
```python
DEFAULT_USER = {
    'username': '新用户名',
    'password': '新密码'
}
```

### 文件会丢失吗

- 上传到服务器的文件保存在磁盘上
- 建议定期备份 `uploads/` 文件夹到本地
- 如果使用云服务器重置系统，文件会丢失

### 如何绑定域名

**需要备案的情况：**
- 服务器在大陆 + 使用域名访问

**免备案方案：**
- 选择香港/海外节点
- 直接用IP访问
- 或使用已备案的域名

详细域名配置请参考阿里云文档。

## 项目结构

```
media-center/
├── app.py              # Flask后端
├── requirements.txt    # 依赖
├── uploads/            # 上传的文件（自动创建）
├── groups.json         # 分组信息
├── templates/
│   ├── index.html      # 主界面
│   └── login.html      # 登录页
└── README.md           # 本文档
```

## 技术栈

- 后端：Python Flask
- 前端：原生 HTML + CSS + JavaScript
- 存储：本地文件系统
- 会话：Flask Session

## 安全提示

⚠️ 当前使用简单会话验证，适合：
- 本地使用
- 信任的内网环境
- 个人小规模使用

**如需公网部署，建议：**
1. 修改 `app.py` 中的 `secret_key` 为随机字符串
2. 使用 HTTPS
3. 修改默认账号密码
4. 定期备份重要文件

## 需要帮助

1. 查看服务器日志排查问题
2. 检查 `uploads/` 文件夹中的文件
3. 使用浏览器开发者工具（F12）查看网络请求
4. 确保文件格式在支持列表中

祝你使用愉快！🎉
